(window["webpackJsonpproject-management-client"]=window["webpackJsonpproject-management-client"]||[]).push([[0],{124:function(e,t,a){},133:function(e,t,a){},134:function(e,t,a){},200:function(e,t,a){e.exports=a(361)},205:function(e,t,a){},206:function(e,t,a){},211:function(e,t,a){},212:function(e,t,a){},230:function(e,t,a){},232:function(e,t,a){},233:function(e,t,a){},240:function(e,t,a){},243:function(e,t,a){},360:function(e,t,a){},361:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(49),o=a.n(s),c=(a(205),a(8)),i=a(9),l=a(11),u=a(10),m=a(12),h=(a(124),a(44)),d=a(19),p=(a(206),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={loggedInUser:null},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.getUser();this.setState({loggedInUser:e})}},{key:"render",value:function(){return this.state.loggedInUser?r.a.createElement("nav",{className:"Navbar",style:{backgroundColor:"#334455",opacity:"0.7"}},r.a.createElement(d.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement("h3",null,"grandMeet")),r.a.createElement("div",{className:"navItems"},r.a.createElement(d.b,{to:"/profile",style:{textDecoration:"none",color:"white"}},r.a.createElement("h4",{className:"navItem"},"Profile")),r.a.createElement(d.b,{to:"/nearby",style:{textDecoration:"none",color:"white"}},r.a.createElement("h4",{className:"navItem"},"Nearby")),r.a.createElement(d.b,{to:"/share",style:{textDecoration:"none",color:"white"}},r.a.createElement("h4",{className:"navItem"},"Share")),r.a.createElement(d.b,{to:"/inbox",style:{textDecoration:"none",color:"white"}},r.a.createElement("i",{className:"navItem fas fa-comments fa-2x"})))):r.a.createElement("nav",{className:"Navbar"},r.a.createElement(d.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement("h3",null,"grandMeet")),r.a.createElement(d.b,{to:"/login",style:{textDecoration:"none",color:"white"}},"Login"))}}]),t}(n.Component)),g=(a(211),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"MainLayout"},r.a.createElement(p,this.props),this.props.children)}}]),t}(n.Component)),f=(a(212),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.userInSession?r.a.createElement("div",{className:"Homepage"},r.a.createElement(g,this.props,r.a.createElement("div",{className:"welcomeInfo"},r.a.createElement("h1",null,"talk.share.meet."),r.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.")))):r.a.createElement("div",{className:"Homepage"},r.a.createElement("nav",{className:"Navbar"},r.a.createElement(d.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement("h3",null,"grandMeet")),r.a.createElement(d.b,{to:"/login",style:{textDecoration:"none",color:"white"}},r.a.createElement("h3",null,"Login"))),r.a.createElement("div",{className:"welcomeInfo"},r.a.createElement("h1",null,"talk.share.meet."),r.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."),r.a.createElement(d.b,{to:"/signup",style:{textDecoration:"none"}},r.a.createElement("button",{className:"registerBtnHome"},"Register"))))}}]),t}(n.Component)),b=a(60),v=a(21),E=a.n(v),y=function(){function e(){var t=this;Object(c.a)(this,e),this.signup=function(e){return E()({method:"POST",baseURL:"".concat("https://grand-meet.herokuapp.com","/signup"),withCredentials:!0,data:e}).then(function(e){return t.setUser(e.data),e.data})},this.loggedin=function(){return t.service.get("/loggedin").then(function(e){return e.data})},this.login=function(e,a,n){return t.service.post("/login",{username:e,password:a,coordinates:n}).then(function(e){return t.setUser(e.data),e.data})},this.logout=function(){return t.service.post("/logout",{}).then(function(){localStorage.removeItem("user")})};var a=E.a.create({baseURL:"".concat("https://grand-meet.herokuapp.com"),withCredentials:!0});this.service=a}return Object(i.a)(e,[{key:"setUser",value:function(e){localStorage.setItem("user",JSON.stringify(e))}}]),e}(),j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleFormSubmit=function(e){e.preventDefault();var t=new FormData(a.formRef.current);a.service.signup(t).then(function(e){a.setState({username:"",password:"",file:null}),a.props.history.push("/profile")}).catch(function(e){return console.log(e)})},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(b.a)({},n,r))},a.uploadPic=function(e){a.setState({file:e.target.files[0]})},a.formRef=r.a.createRef(),a.state={username:"",password:"",file:null},a.service=new y,a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"loginPage"},r.a.createElement("nav",{className:"Navbar"},r.a.createElement(d.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement("h3",null,"grandMeet")),r.a.createElement(d.b,{to:"/login",style:{textDecoration:"none",color:"white"}},r.a.createElement("h3",null,"Login"))),r.a.createElement(d.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement("i",{className:"fas fa-times-circle fa-2x"})),r.a.createElement("div",{className:"signupForm"},r.a.createElement("h3",null,"Register"),r.a.createElement("form",{className:"loginInput",ref:this.formRef,onSubmit:this.handleFormSubmit},r.a.createElement("label",null,"Username:"),r.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:function(t){return e.handleChange(t)}}),r.a.createElement("label",null,"Password:"),r.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:function(t){return e.handleChange(t)}}),r.a.createElement("label",null,"Profile Picture:"),r.a.createElement("input",{type:"file",name:"picture",onChange:this.uploadPic}),r.a.createElement("button",{className:"submitBtn",type:"submit"},"Register")),r.a.createElement("p",null,"Already have account?",r.a.createElement(d.b,{to:"/login",style:{color:"rgb(5, 5, 5)",textDecoration:"underline"}}," Login"))))}}]),t}(n.Component),O=(a(230),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).logoutUser=function(){a.service.logout().then(function(){a.setState({loggedInUser:null}),a.props.history.push("/")})},a.state={loggedInUser:null},a.service=new y,a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.getUser();this.setState({loggedInUser:e})}},{key:"render",value:function(){var e=this;return this.state.loggedInUser?r.a.createElement(g,this.props,r.a.createElement("div",{className:"ProfilePage"},r.a.createElement("div",{className:"profilePic",style:{backgroundImage:"url(".concat(this.state.loggedInUser.profilePicUrl,")")}}),r.a.createElement(d.b,{style:{textDecoration:"none"},to:"/editProfile"},r.a.createElement("div",{className:"editIcon"})),r.a.createElement("h3",null,this.state.loggedInUser.username),r.a.createElement("hr",{style:{width:"100%"}}),r.a.createElement("p",{className:"aboutSect"},"About: ",this.state.loggedInUser.about," "),r.a.createElement(d.b,{to:"/"},r.a.createElement("button",{style:{margin:"20px 0"},className:"registerBtn",onClick:function(){return e.logoutUser()}},"Logout")))):r.a.createElement(g,this.props,"Loading...")}}]),t}(n.Component)),k=(a(133),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleFormSubmit=function(e){e.preventDefault();var t=new FormData(a.formRef.current);t.append("user",a.props.userInSession._id),E()({method:"POST",baseURL:"".concat("https://grand-meet.herokuapp.com","/edit"),withCredentials:!0,data:t}).then(function(e){a.setState({about:"",file:null}),localStorage.setItem("user",JSON.stringify(e.data)),a.props.history.push("/profile")}).catch(function(e){return console.log(e)})},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(b.a)({},n,r))},a.uploadPic=function(e){a.setState({file:e.target.files[0]})},a.formRef=r.a.createRef(),a.state={about:"",file:null},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(g,this.props,r.a.createElement("form",{className:"editPage signupForm",ref:this.formRef,onSubmit:this.handleFormSubmit},r.a.createElement("label",null,"About "),r.a.createElement("input",{style:{height:"100px",width:"300px"},type:"text",name:"about",value:this.state.about,onChange:function(t){return e.handleChange(t)}}),r.a.createElement("label",null,"Profile Picture "),r.a.createElement("input",{style:{border:"solid 1px grey",width:"300px"},type:"file",name:"picture",onChange:this.uploadPic}),r.a.createElement("button",{className:"submitBtn"},"Save")))}}]),t}(n.Component)),S=a(88),C=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleFormSubmit=function(e){e.preventDefault();var t=a.state.username,n=a.state.password;a.service.login(t,n,{longitude:a.props.coords.longitude,latitude:a.props.coords.latitude}).then(function(e){a.setState({username:"",password:""}),a.props.history.push("/profile")}).catch(function(e){return console.log(e)})},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(b.a)({},n,r))},a.state={username:"",password:""},a.service=new y,a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"loginPage"},r.a.createElement("nav",{className:"Navbar"},r.a.createElement(d.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement("h3",null,"grandMeet")),r.a.createElement(d.b,{to:"/login",style:{textDecoration:"none",color:"white"}},"Login")),r.a.createElement(d.b,{to:"/",style:{textDecoration:"none",color:"white"}},r.a.createElement("i",{className:"fas fa-times-circle fa-2x"})),r.a.createElement("div",{className:"loginForm"},r.a.createElement("h3",null,"Log in"),r.a.createElement("form",{className:"loginInput",onSubmit:this.handleFormSubmit},r.a.createElement("label",null,"Username:"),r.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:function(t){return e.handleChange(t)}}),r.a.createElement("label",null,"Password:"),r.a.createElement("input",{type:"text",name:"password",value:this.state.password,onChange:function(t){return e.handleChange(t)}}),r.a.createElement("button",{className:"submitBtn",type:"submit"},"Log in")),r.a.createElement("p",null,"Don't have account?",r.a.createElement(d.b,{to:"/signup",style:{color:"rgb(5, 5, 5)",textDecoration:"underline"}}," Register"))))}}]),t}(n.Component),U=Object(S.geolocated)({positionOptions:{enableHighAccuracy:!1},userDecisionTimeout:5e3})(C),I=a(26),w=(a(232),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e)))._isMounted=!1,a.calculateUserDist=function(e){for(var t=a.props.userInSession.longitude,n=a.props.userInSession.latitude,r=0;r<e.length;r++){var s=e[r].longitude,o=e[r].latitude;e[r].distance=a.calculateDistance(n,t,o,s)}return e.sort(function(e,t){return e.distance-t.distance}),e},a.state={users:[],sortedUsers:[]},a.calculateDistance=a.calculateDistance.bind(Object(I.a)(a)),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"calculateDistance",value:function(e,t,a,n){e=Math.PI*e/180,a=Math.PI*a/180,t=Math.PI*t/180;var r=((n=Math.PI*n/180)-t)*Math.cos((e+a)/2),s=a-e;return Math.floor(6371*Math.sqrt(r*r+s*s))}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,E.a.get("".concat("https://grand-meet.herokuapp.com","/nearby"),{withCredentials:!0}).then(function(t){if(e._isMounted){var a=e.calculateUserDist(t.data);e.setState({sortedUsers:a}),e.props.history.push("/nearby")}})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){if(this.state.sortedUsers.length>0){var e=this.state.sortedUsers.map(function(e){return r.a.createElement(d.b,{style:{textDecoration:"none"},to:{pathname:"/nearby/".concat(e._id),nearbyUserProps:{user:e}}},r.a.createElement("div",{className:"avaPic eachUser",style:{backgroundImage:"url(".concat(e.profilePicUrl,")")}},r.a.createElement("div",null,r.a.createElement("h4",null,e.username),r.a.createElement("p",null,r.a.createElement("i",{className:"fas fa-map-marker-alt"})," ",e.distance,"km"))))});return r.a.createElement(g,this.props,r.a.createElement("div",{className:"NearbyPage"},e))}return r.a.createElement(g,this.props,r.a.createElement("h1",null,"Loading..."))}}]),t}(n.Component)),R=Object(S.geolocated)({positionOptions:{enableHighAccuracy:!1},userDecisionTimeout:5e3})(w),N=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;E.a.get("".concat("https://grand-meet.herokuapp.com","/nearby/").concat(t.id),{withCredentials:!0}).then(function(t){var a=t.data;e.setState(a)}).catch(function(e){console.log(e)})}},{key:"render",value:function(){return r.a.createElement("div",{className:"NearbyUser"},r.a.createElement(g,this.props,r.a.createElement("div",{className:"avaPic",style:{backgroundImage:"url(".concat(this.state.profilePicUrl,")")}}),r.a.createElement("h3",null,this.state.username),r.a.createElement("p",null,r.a.createElement("i",{className:"fas fa-map-marker-alt"})," ",this.props.location.nearbyUserProps.user.distance,"km"),r.a.createElement("hr",null),r.a.createElement("p",null,this.state.about),r.a.createElement(d.b,{to:{pathname:"/chat/".concat(this.state._id),chatPartner:{user:this.props.location.nearbyUserProps.user}}},r.a.createElement("button",{style:{margin:"20px 0"},className:"",type:"submit"},"Message"))))}}]),t}(n.Component),x=(a(233),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={user:JSON.parse(localStorage.getItem("user")),otherUsers:{}},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.a.get("".concat("https://grand-meet.herokuapp.com","/nearby"),{withCredentials:!0}).then(function(t){e.setState({otherUsers:t.data})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.props.rooms.map(function(t,a){var n=t.member_user_ids.filter(function(t){return t!==e.state.user.username})[0],s=e.state.otherUsers.filter(function(e){return e.username===n})[0],o=t.id===e.props.currentRoom.id?"active":"";return r.a.createElement(d.b,{className:"eachRoom",to:"/inbox/".concat(t.id),key:a},r.a.createElement("li",{className:o,key:t.id},r.a.createElement("div",{className:"inboxList"},r.a.createElement("div",{className:"eachMesDiv",style:{backgroundImage:"url(".concat(s.profilePicUrl,")")}}),n)))});return r.a.createElement("ul",{className:"roomsTab"},t)}}]),t}(n.Component)),P=a(43),M=a(32),D=(a(240),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.messages.map(function(t,a){return t.senderId===e.props.userInSession.username?r.a.createElement("div",{key:a,className:"currentUserDiv"},r.a.createElement("p",{className:"currentUser"},t.text)):r.a.createElement("div",{key:a},r.a.createElement("p",{className:"chatPartner"},t.text))});return r.a.createElement("div",{className:"MessageList"},t)}}]),t}(n.Component)),_=a(370),T=a(189);a(242),a(243);var L=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={message:"",showEmojiPicker:!1},a.handleChange=a.handleChange.bind(Object(I.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(I.a)(a)),a.addEmoji=function(e){var t=this.state.message,a="".concat(t).concat(e.native);this.setState({message:a,showEmojiPicker:!1})}.bind(Object(I.a)(a)),a.toggleEmojiPicker=function(){this.setState({showEmojiPicker:!this.state.showEmojiPicker})}.bind(Object(I.a)(a)),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.setState({message:e.target.value})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.onSubmit(this.state.message),this.setState({message:""})}},{key:"render",value:function(){var e=this.state.showEmojiPicker;return r.a.createElement(r.a.Fragment,null,e?r.a.createElement(T.a,{set:"emojione",onSelect:this.addEmoji}):null,r.a.createElement("form",{onSubmit:this.handleSubmit,className:"input-field"},r.a.createElement("button",{type:"button",className:"toggle-emoji",onClick:this.toggleEmojiPicker},r.a.createElement(_.a,null)),r.a.createElement("input",{className:"message-input",type:"text",placeholder:"Type your message and hit ENTER to send...",onChange:this.handleChange,value:this.state.message})))}}]),t}(n.Component),F=(a(134),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={currentUser:null,userInSession:JSON.parse(localStorage.getItem("user")),currentRoom:{users:[]},messages:[],users:[]},a.addMessage=a.addMessage.bind(Object(I.a)(a)),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;if(e.match.params.id!==this.props.match.params.id){var a=this.props.match.params.id;new M.ChatManager({instanceLocator:"v1:us1:95077b15-c43c-4d68-ae92-7a1f082f91c8",userId:this.state.userInSession.username,tokenProvider:new M.TokenProvider({url:"".concat("https://grand-meet.herokuapp.com","/authenticate")})}).connect().then(function(e){t.setState({currentUser:e,messages:[]}),e.subscribeToRoom({roomId:"".concat(a),messageLimit:50,hooks:{onMessage:function(e){t.setState({messages:[].concat(Object(P.a)(t.state.messages),[e])})}}}).then(function(e){console.log(e.userIds),t.setState({currentRoom:e,users:e.userIds}),t.props.setRoom(e)}).catch(function(e){return console.log(e)})})}}},{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;new M.ChatManager({instanceLocator:"v1:us1:95077b15-c43c-4d68-ae92-7a1f082f91c8",userId:this.state.userInSession.username,tokenProvider:new M.TokenProvider({url:"".concat("https://grand-meet.herokuapp.com","/authenticate")})}).connect().then(function(a){e.setState({currentUser:a,message:[]}),a.subscribeToRoom({roomId:"".concat(t),messageLimit:50,hooks:{onMessage:function(t){e.setState({messages:[].concat(Object(P.a)(e.state.messages),[t])})}}}).then(function(t){e.setState({currentRoom:t,users:t.userIds}),e.props.setRoom(t)}).catch(function(e){return console.log(e)})})}},{key:"addMessage",value:function(e){this.state.currentUser.sendMessage({text:e,roomId:this.state.currentRoom.id}).catch(function(e){return console.error("error",e)})}},{key:"render",value:function(){return r.a.createElement("div",{className:"eachRoom"},r.a.createElement(D,{messages:this.state.messages,userInSession:this.state.userInSession}),r.a.createElement(L,{className:"input-field-one",onSubmit:this.addMessage}))}}]),t}(n.Component)),B=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).setCurrentRoom=function(e){a.setState({currentRoom:e})},a.state={chatRooms:[],currentUser:{},currentRoom:{}},a.setCurrentRoom=a.setCurrentRoom.bind(Object(I.a)(a)),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.getUser();E.a.get("".concat("https://grand-meet.herokuapp.com","/inbox"),{withCredentials:!0}).then(function(a){console.log(a);var n=a.data;e.setState({chatRooms:n,currentUser:t})})}},{key:"render",value:function(){var e=this;return r.a.createElement(g,Object.assign({},this.props,{className:"Dashboard"}),r.a.createElement("div",{className:"inboxPage"},r.a.createElement(x,{rooms:this.state.chatRooms,currentUser:this.state.currentUser,currentRoom:this.state.currentRoom}),r.a.createElement(h.a,{path:"/inbox/:id",render:function(t){return r.a.createElement(F,Object.assign({rooms:e.state.chatRooms,userInSession:e.state.currentUser,setRoom:e.setCurrentRoom},t))}})))}}]),t}(n.Component),H=(a(244),function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={username:""},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{class:"loginToCommon"},r.a.createElement("form",{className:"loginToCommonForm",onSubmit:this.handleFormSubmit.bind(this)},r.a.createElement("label",null,"Welcome to the Common Room!"),r.a.createElement("input",{placeholder:"Enter your username",value:this.state.username,onChange:this.handleUsernameChange.bind(this)}),r.a.createElement("button",{type:"submit"},"Enter")))}},{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handleFormSubmit",value:function(){this.state.username&&this.props.login(this.state.username)}}]),t}(r.a.Component)),A=a(372),W=a(45),J=a(374);function G(e){var t=e.joined,a=e.joinable,n=e.activeRoom,s=e.enterRoom,o=e.leaveRoom,c=t.map(function(e){return r.a.createElement(A.a.Item,{key:e.id},r.a.createElement(A.a.Content,{floated:"right"},r.a.createElement("a",{onClick:function(){return o(e.id)}},"Leave")),r.a.createElement(W.a,{name:e.id===n?"right triangle":""}),r.a.createElement(A.a.Content,null,r.a.createElement("a",{onClick:function(){return s(e.id)}},e.name)))}),i=a.map(function(e){return r.a.createElement(A.a.Item,{key:e.id},r.a.createElement(W.a,{name:""}),r.a.createElement(A.a.Content,null,r.a.createElement("a",{onClick:function(){return s(e.id)}},e.name)))});return r.a.createElement("div",null,r.a.createElement(J.a,{as:"h4"},"Active Rooms"),r.a.createElement(A.a,{divided:!0,relaxed:!0},c),r.a.createElement(J.a,{as:"h4"},"Joinable Rooms"),r.a.createElement(A.a,{divided:!0,relaxed:!0},i))}var V=a(371),z=a(375),q=a(178),K=new(a.n(q).a)("4c266cab29bd293c0092",{cluster:"eu",forceTLS:!0}),Q={WK:"\u2654",WQ:"\u2655",WR:"\u2656",WB:"\u2657",WN:"\u2658",WP:"\u2659",BK:"\u265a",BQ:"\u265b",BR:"\u265c",BB:"\u265d",BN:"\u265e",BP:"\u265f"},Y=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={board:[],players:{}},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t=this,a=this.state.board.map(function(e,t){return e.map(function(e,a){var n=Q[e];if(n)return r.a.createElement("text",{key:t+"-"+a,x:a,y:t+.8,style:{font:"1px sans-serif"}},n)}).filter(function(e){return e})});this.state.activeCell&&(e=r.a.createElement("rect",{x:this.state.activeCell.x,y:this.state.activeCell.y,width:"1",height:"1",fillOpacity:"0.5",fill:"#F00"}));var n=Object.keys(this.state.players).map(function(e){var a=t.state.players[e];return r.a.createElement(A.a.Item,null,r.a.createElement(A.a.Header,null,a),e)});return r.a.createElement(z.a,null,r.a.createElement(z.a.Row,{columns:2},r.a.createElement(z.a.Column,null,r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200",viewBox:"-.05 -.05 8.1 8.1"},r.a.createElement("rect",{x:"-.5",y:"-.5",width:"9",height:"9",style:{fill:"#F4A460"}}),r.a.createElement("path",{fill:"#FFEBCD",d:"M0,0H8v1H0zm0,2H8v1H0zm0 2H8v1H0zm0,2H8v1H0zM1,0V8h1V0zm2,0V8h1V0zm2 0V8h1V0zm2,0V8h1V0z"}),[].concat.apply([],a),e,r.a.createElement("rect",{x:"0",y:"0",width:"8",height:"8",fillOpacity:"0.1",onClick:function(e){return t._handleBoardClick(e)}}))),r.a.createElement(z.a.Column,null,r.a.createElement(A.a,null,n))))}},{key:"componentDidMount",value:function(){var e=this,t=this.props.room;K.subscribe("game-".concat(t)).bind("board-updated",function(){e._refreshGame()}),this._refreshGame()}},{key:"componentWillUnmount",value:function(){var e=this.props.room;K.unsubscribe("game-".concat(e))}},{key:"_handleBoardClick",value:function(e){var t=e.target.getBoundingClientRect(),a=e.clientX-t.left,n=e.clientY-t.top,r=Math.floor(a/200*8),s=Math.floor(n/200*8);this.state.activeCell?this.state.activeCell.x===r&&this.state.activeCell.y===s?this.setState({activeCell:null}):(E.a.request({method:"POST",url:"".concat("https://grand-meet.herokuapp.com","/games/")+this.props.room,data:{player:this.props.user.id,fromRow:this.state.activeCell.y,fromColumn:this.state.activeCell.x,toRow:s,toColumn:r}}),this.setState({activeCell:null})):this.setState({activeCell:{x:r,y:s}})}},{key:"_refreshGame",value:function(){var e=this;E.a.request({url:"".concat("https://grand-meet.herokuapp.com","/games/")+this.props.room}).then(function(t){e.setState({board:t.data.board,players:t.data.players})})}},{key:"getPlayers",value:function(){return Object.keys(this.state.players)}}]),t}(r.a.Component),X=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={users:a.props.room.userIds,messages:[],newMessage:""},e.user.subscribeToRoom({roomId:e.room.id,messageLimit:50,hooks:{onUserJoined:function(t){a.setState({users:e.room.users})},onUserLeft:function(t){a.setState({users:e.room.users})},onMessage:function(t){var n,r=a.state.messages;t.attachment&&t.attachment.link&&t.attachment.link.startsWith("urn:player:")&&(n=t.attachment.link.substring(11))!==e.user.id&&(n=void 0),r.push({id:t.id,user:t.senderId,message:a.state.newMessage,opponent:n}),a.setState({messages:[].concat(Object(P.a)(r),[t])})}}}).then(function(e){a.setState({user:e.userIds})}),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state.users.filter(function(t){return t.id!==e.props.user.id}).map(function(t){return r.a.createElement("li",{style:{listStyle:"none"},key:t.id},r.a.createElement("b",{style:{margin:"0",padding:"0"}},t.name),r.a.createElement("p",{style:{floated:"right"}},r.a.createElement("a",{onClick:function(){return e._challengePlayer(t)}},"Challenge")))}),a=this.state.messages.map(function(t){var a;return t.opponent&&(a=r.a.createElement("a",{onClick:function(){return e._acceptChallenge(t.user)}},"Accept Challenge")),r.a.createElement("div",{className:"columnFlex"},r.a.createElement("h4",{className:"flexpart"},t.user),r.a.createElement("p",{className:"flexpart"},t.text),a)});return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"rowFlex"},r.a.createElement("div",{className:"allMessages"},this.props.game&&r.a.createElement(Y,{room:this.props.game,user:this.props.user,ref:function(t){e._gameBoard=t}}),r.a.createElement("div",{className:"ColumnFlex"},a),r.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(t){e.messagesEnd=t}})),r.a.createElement("div",{className:"availableUsers"},r.a.createElement("ul",null,r.a.createElement("li",{style:{listStyle:"none"}},r.a.createElement("b",null,"You: ",this.props.user.name)),t))),r.a.createElement("div",null,r.a.createElement(V.a,{onSubmit:this._handleSubmit.bind(this)},r.a.createElement("input",{className:"typeText",type:"text",placeholder:"New Message...",value:this.state.newMessage,onChange:this._handleNewMessageChange.bind(this)}))))}},{key:"componentDidMount",value:function(){this._scrollToBottom()}},{key:"componentDidUpdate",value:function(){this._scrollToBottom()}},{key:"_scrollToBottom",value:function(){this.messagesEnd.scrollIntoView({behavior:"smooth"})}},{key:"_handleNewMessageChange",value:function(e){this.setState({newMessage:e.target.value})}},{key:"_handleSubmit",value:function(){var e=this.state.newMessage,t=this.props,a=t.user,n=t.room;a.sendMessage({text:e,roomId:n.id}),this.setState({newMessage:""})}},{key:"_challengePlayer",value:function(e){var t=this.props,a=t.user,n=t.room;a.sendMessage({text:"I challenge ".concat(e.name," to a game"),roomId:n.id,attachment:{link:"urn:player:".concat(e.id),type:"file",fetchRequired:!1}})}},{key:"_acceptChallenge",value:function(e){var t=this,a=this.props.user;a.createRoom({name:"".concat(a.id," vs ").concat(e),addUserIds:[e]}).then(function(n){t.props.startedGame(n.id,a.id,e)})}},{key:"getPlayersInRoom",value:function(){var e=this._gameBoard?this._gameBoard.getPlayers():[];return this.state.users.filter(function(t){return e.includes(t.id)})}}]),t}(r.a.Component),$=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={joined:[],joinable:[]},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;new M.ChatManager({instanceLocator:"v1:us1:95077b15-c43c-4d68-ae92-7a1f082f91c8",userId:this.props.username,tokenProvider:new M.TokenProvider({url:"".concat("https://grand-meet.herokuapp.com","/commonRoom")})}).connect().then(function(t){console.log(t),e.setState({currentUser:t}),t.getJoinableRooms().then(function(a){var n=a.find(function(e){return"Lobby"===e.name});n?t.joinRoom({roomId:n.id}):n=t.rooms.find(function(e){return"Lobby"===e.name}),n&&e.setState({lobbyId:n.id,activeRoom:n.id})}),setInterval(e._pollRooms.bind(e),5e3),e._pollRooms()}).catch(function(e){console.log("Failed to connect to Chatkit"),console.log(e)})}},{key:"_pollRooms",value:function(){var e=this,t=this.state.currentUser;t.getJoinableRooms().then(function(a){e.setState({joined:t.rooms,joinable:a})})}},{key:"_enterRoom",value:function(e){var t=this;this.state.currentUser.joinRoom({roomId:e}).then(function(){t.setState({activeRoom:e}),t._pollRooms()}).catch(function(){console.log("Failed to enter room")})}},{key:"_leaveRoom",value:function(e){var t=this;this.state.currentUser.leaveRoom({roomId:e}).then(function(){t._pollRooms()}).catch(function(){console.log("Failed to leave room")})}},{key:"_startedGame",value:function(e,t,a){var n=this;E.a.request({url:"".concat("https://grand-meet.herokuapp.com","/games"),method:"POST",data:{room:e,whitePlayer:t,blackPlayer:a}}).then(function(t){n.setState({activeRoom:e}),n._pollRooms()})}},{key:"render",value:function(){var e,t=this,a=this.state.currentUser;if(a){var n=a.rooms.find(function(e){return e.id===t.state.activeRoom});if(n){var s=this.state.activeRoom!==this.state.lobbyId&&this.state.activeRoom;e=r.a.createElement(X,{user:a,room:n,key:n.id,startedGame:this._startedGame.bind(this),game:s})}}return r.a.createElement("div",{className:"rowFlex gamePage"},r.a.createElement("div",{className:"differentRooms"},r.a.createElement(G,{joined:this.state.joined,joinable:this.state.joinable,activeRoom:this.state.activeRoom,enterRoom:this._enterRoom.bind(this),leaveRoom:this._leaveRoom.bind(this)})),r.a.createElement("div",{className:"chatArea"},e))}}]),t}(r.a.Component),Z=(a(360),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"enterGame",value:function(e){this.setState({username:e})}},{key:"render",value:function(){var e;return e=this.state.username?r.a.createElement($,{username:this.state.username}):r.a.createElement(H,{login:this.enterGame.bind(this)}),r.a.createElement(r.a.Fragment,null,e)}}]),t}(r.a.Component)),ee=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(g,this.props,r.a.createElement("div",{className:"columnFlex",style:{width:"100%",height:"88vh",justifyContent:"space-between"}},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(d.b,{style:{textDecoration:"none",color:"black"},to:"/share/commonRoom"},r.a.createElement("h4",null,"Common Room")),r.a.createElement(d.b,{style:{textDecoration:"none",color:"black"},to:"/sharingThings"},r.a.createElement("h4",null,"Sharing Corner"))),r.a.createElement(h.a,{path:"/share/commonRoom",render:function(e){return r.a.createElement(Z,e)}})))}}]),t}(n.Component),te=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={currentUser:null,chatPartner:a.props.location.chatPartner.user,currentRoom:{users:[]},messages:[],users:[]},a.addMessage=a.addMessage.bind(Object(I.a)(a)),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.a.get("".concat("https://grand-meet.herokuapp.com","/newChat"),{withCredentials:!0}).then(function(t){for(var a=t.data,n="",r=0;r<a.length;r++)for(var s=a[r].member_user_ids,o=0;o<s.length;o++)if(s[o]===e.state.chatPartner.username){n=a[r].id;break}var c=new M.ChatManager({instanceLocator:"v1:us1:95077b15-c43c-4d68-ae92-7a1f082f91c8",userId:e.props.userInSession.username,tokenProvider:new M.TokenProvider({url:"".concat("https://grand-meet.herokuapp.com","/authenticate")})});n?c.connect().then(function(t){e.setState({currentUser:t}),t.subscribeToRoom({roomId:"".concat(n),messageLimit:100,hooks:{onMessage:function(t){e.setState({messages:[].concat(Object(P.a)(e.state.messages),[t])})}}}).then(function(t){console.log(t.userIds),e.setState({currentRoom:t,users:t.userIds})}).catch(function(e){return console.log(e)})}):c.connect().then(function(t){return e.setState({currentUser:t}),t.createRoom({name:"".concat(e.props.location.chatPartner.user.username),private:!0,addUserIds:["".concat(e.state.chatPartner.username)],customData:{foo:42}}).then(function(a){return t.subscribeToRoom({roomId:"".concat(a.id),messageLimit:100,hooks:{onMessage:function(t){e.setState({messages:[].concat(Object(P.a)(e.state.messages),[t])})}}}).then(function(t){console.log(t.userIds),e.setState({currentRoom:t,users:t.userIds})}).catch(function(e){return console.log(e)})})})})}},{key:"addMessage",value:function(e){this.state.currentUser.sendMessage({text:e,roomId:this.state.currentRoom.id}).catch(function(e){return console.error("error",e)})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(D,Object.assign({messages:this.state.messages},this.props)),r.a.createElement(L,{className:"input-field",onSubmit:this.addMessage}))}}]),t}(n.Component),ae=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(g,this.props,r.a.createElement(te,this.props))}}]),t}(n.Component),ne=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getTheUser=function(){return JSON.parse(localStorage.getItem("user"))},a.state={loggedInUser:null},a.service=new y,a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"fetchUser",value:function(){var e=this;null===this.state.loggedInUser&&this.service.loggedin().then(function(t){e.setState({loggedInUser:t})}).catch(function(t){e.setState({loggedInUser:!1})})}},{key:"render",value:function(){var e=this;return this.fetchUser(),r.a.createElement("div",{className:"App"},r.a.createElement(h.a,{exact:!0,path:"/profile",render:function(t){return r.a.createElement(O,Object.assign({userInSession:e.state.loggedInUser,getUser:e.getTheUser},t))}}),r.a.createElement(h.a,{exact:!0,path:"/editProfile",render:function(t){return r.a.createElement(k,Object.assign({userInSession:e.state.loggedInUser,getUser:e.getTheUser},t))}}),r.a.createElement(h.a,{exact:!0,path:"/nearby",render:function(t){return r.a.createElement(R,Object.assign({userInSession:e.state.loggedInUser,getUser:e.getTheUser},t))}}),r.a.createElement(h.a,{exact:!0,path:"/nearby/:id",render:function(t){return r.a.createElement(N,Object.assign({userInSession:e.state.loggedInUser,getUser:e.getTheUser},t))}}),r.a.createElement(h.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(f,Object.assign({userInSession:e.state.loggedInUser,getUser:e.getTheUser},t))}}),r.a.createElement(h.a,{exact:!0,path:"/signup",render:function(t){return r.a.createElement(j,Object.assign({getUser:e.getTheUser},t))}}),r.a.createElement(h.a,{exact:!0,path:"/login",render:function(t){return r.a.createElement(U,Object.assign({getUser:e.getTheUser},t))}}),r.a.createElement(h.a,{path:"/inbox",render:function(t){return r.a.createElement(B,Object.assign({userInSession:e.state.loggedInUser,getUser:e.getTheUser},t))}}),r.a.createElement(h.a,{exact:!0,path:"/chat/:id",render:function(t){return r.a.createElement(ae,Object.assign({userInSession:e.state.loggedInUser,getUser:e.getTheUser},t))}}),r.a.createElement(h.a,{path:"/share",render:function(t){return r.a.createElement(ee,Object.assign({userInSession:e.state.loggedInUser,getUser:e.getTheUser},t))}}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(d.a,null,r.a.createElement(ne,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[200,1,2]]]);
//# sourceMappingURL=main.495c2d1d.chunk.js.map